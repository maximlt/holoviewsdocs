
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>holoviews.plotting.util â€” HoloViews v1.14.7a1</title>
<link href="../../../_static/css/theme.css" rel="stylesheet"/>
<link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/css/blank.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/graphviz.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/nbsite.css" rel="stylesheet" type="text/css">
<link href="../../../_static/css/custom.css" rel="stylesheet" type="text/css">
<link as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js" rel="preload">
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<link href="../../../_static/favicon.ico" rel="shortcut icon"/>
<link href="../../../about.html" rel="author" title="About these documents">
<link href="../../../genindex.html" rel="index" title="Index">
<link href="../../../search.html" rel="search" title="Search"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-61554933-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>
</link></link></link></link></link></link></head>
<body data-offset="80" data-spy="scroll" data-target="#bd-toc-nav">
<div class="container-fluid" id="banner"></div>
<nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">
<div id="navbar-start">
<a class="navbar-brand" href="../../../index.html">
<img alt="logo" class="logo" src="../../../_static/logo_horizontal.png"/>
</a>
</div>
<button aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbar-collapsible" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="col-lg-9 collapse navbar-collapse" id="navbar-collapsible">
<div class="mr-auto" id="navbar-center">
<div class="navbar-center-item">
<ul class="navbar-nav" id="navbar-main-elements">
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../../index.html">
  Home
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../../reference/index.html">
  Reference Gallery
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../../releases.html">
  Releases
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../../reference_manual/index.html">
  API
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../../FAQ.html">
  FAQ
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../../roadmap.html">
  Roadmap
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference external nav-link" href="https://github.com/holoviz/holoviews">
  Github source
 </a>
</li>
<li class="toctree-l1 nav-item">
<a class="reference internal nav-link" href="../../../about.html">
  About
 </a>
</li>
</ul>
</div>
</div>
<div id="navbar-end">
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
<li class="nav-item">
<a class="nav-link" href="https://github.com/holoviz/holoviews" rel="noopener" target="_blank" title="GitHub">
<span><i class="fab fa-github-square"></i></span>
<label class="sr-only">GitHub</label>
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://twitter.com/holoviews" rel="noopener" target="_blank" title="Twitter">
<span><i class="fab fa-twitter-square"></i></span>
<label class="sr-only">Twitter</label>
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://discourse.holoviz.org/" rel="noopener" target="_blank" title="Discourse">
<span><i class="fab fa-discourse"></i></span>
<label class="sr-only">Discourse</label>
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</nav>
<div class="container-xl">
<div class="row">
<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="col-12 col-md-3 bd-sidebar"><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search the docs ..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." type="search"/>
</form><nav aria-label="Main navigation" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
</div>
</nav>
</div>
<div class="d-none d-xl-block col-xl-2 bd-toc">
</div>
<main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
<div>
<h1>Source code for holoviews.plotting.util</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">bisect</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">namedtuple</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">param</span>

<span class="kn">from</span> <span class="nn">..core</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">HoloMap</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="n">Overlay</span><span class="p">,</span> <span class="n">GridSpace</span><span class="p">,</span>
    <span class="n">NdLayout</span><span class="p">,</span> <span class="n">NdOverlay</span><span class="p">,</span> <span class="n">AdjointLayout</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">..core.options</span> <span class="kn">import</span> <span class="n">CallbackError</span><span class="p">,</span> <span class="n">Cycle</span>
<span class="kn">from</span> <span class="nn">..core.operation</span> <span class="kn">import</span> <span class="n">Operation</span>
<span class="kn">from</span> <span class="nn">..core.ndmapping</span> <span class="kn">import</span> <span class="n">item_check</span>
<span class="kn">from</span> <span class="nn">..core.spaces</span> <span class="kn">import</span> <span class="n">get_nested_streams</span>
<span class="kn">from</span> <span class="nn">..core.util</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">match_spec</span><span class="p">,</span> <span class="n">wrap_tuple</span><span class="p">,</span> <span class="n">get_overlay_spec</span><span class="p">,</span> <span class="n">unique_iterator</span><span class="p">,</span>
    <span class="n">closest_match</span><span class="p">,</span> <span class="n">is_number</span><span class="p">,</span> <span class="n">isfinite</span><span class="p">,</span> <span class="n">python2sort</span><span class="p">,</span> <span class="n">disable_constant</span><span class="p">,</span>
    <span class="n">arraylike_types</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">..streams</span> <span class="kn">import</span> <span class="n">LinkedStream</span><span class="p">,</span> <span class="n">Params</span>
<span class="kn">from</span> <span class="nn">..util.transform</span> <span class="kn">import</span> <span class="n">dim</span>


<div class="viewcode-block" id="displayable"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.displayable">[docs]</a><span class="k">def</span> <span class="nf">displayable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Predicate that returns whether the object is displayable or not</span>
<span class="sd">    (i.e. whether the object obeys the nesting hierarchy)</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Overlay</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="p">(</span><span class="n">HoloMap</span><span class="p">,</span> <span class="n">GridSpace</span><span class="p">,</span> <span class="n">AdjointLayout</span><span class="p">))</span>
                                        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">HoloMap</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Layout</span><span class="p">,</span> <span class="n">GridSpace</span><span class="p">,</span> <span class="n">NdLayout</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">GridSpace</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="n">NdLayout</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">displayable</span><span class="p">(</span><span class="n">el</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Warning"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.Warning">[docs]</a><span class="k">class</span> <span class="nc">Warning</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">Parameterized</span><span class="p">):</span> <span class="k">pass</span></div>
<span class="n">display_warning</span> <span class="o">=</span> <span class="ne">Warning</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Warning'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">collate</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Overlay</span><span class="p">):</span>
        <span class="n">nested_type</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obj</span>
                       <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="p">(</span><span class="n">HoloMap</span><span class="p">,</span> <span class="n">GridSpace</span><span class="p">,</span> <span class="n">AdjointLayout</span><span class="p">))][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">display_warning</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">"Nesting </span><span class="si">%s</span><span class="s2">s within an Overlay makes it difficult to "</span>
            <span class="s2">"access your data or control how it appears; we recommend "</span>
            <span class="s2">"calling .collate() on the Overlay in order to follow the "</span>
            <span class="s2">"recommended nesting structure shown in the Composing Data "</span>
            <span class="s2">"user guide (http://goo.gl/2YS8LJ)"</span> <span class="o">%</span> <span class="n">nested_type</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">collate</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">DynamicMap</span><span class="p">,</span> <span class="n">HoloMap</span><span class="p">]:</span>
            <span class="n">obj_name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"Nesting a </span><span class="si">%s</span><span class="s2"> inside a DynamicMap is not "</span>
                            <span class="s2">"supported. Ensure that the DynamicMap callback "</span>
                            <span class="s2">"returns an Element or (Nd)Overlay. If you have "</span>
                            <span class="s2">"applied an operation ensure it is not dynamic by "</span>
                            <span class="s2">"setting dynamic=False."</span> <span class="o">%</span> <span class="n">obj_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">collate</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">HoloMap</span><span class="p">):</span>
        <span class="n">display_warning</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">"Nesting </span><span class="si">{0}</span><span class="s2">s within a </span><span class="si">{1}</span><span class="s2"> makes it difficult to access "</span>
            <span class="s2">"your data or control how it appears; we recommend "</span>
            <span class="s2">"calling .collate() on the </span><span class="si">{1}</span><span class="s2"> in order to follow the "</span>
            <span class="s2">"recommended nesting structure shown in the Composing "</span>
            <span class="s2">"Data user guide (https://goo.gl/2YS8LJ)"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">collate</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">Layout</span><span class="p">,</span> <span class="n">NdLayout</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">display_warning</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">"Layout contains HoloMaps which are not nested in the "</span>
                <span class="s2">"recommended format for accessing your data; calling "</span>
                <span class="s2">".collate() on these objects will resolve any violations "</span>
                <span class="s2">"of the recommended nesting presented in the Composing Data "</span>
                <span class="s2">"tutorial (https://goo.gl/2YS8LJ)"</span><span class="p">)</span>
            <span class="n">expanded</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">HoloMap</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">displayable</span><span class="p">(</span><span class="n">el</span><span class="p">):</span>
                    <span class="n">collated_layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">collate</span><span class="p">())</span>
                    <span class="n">expanded</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">collated_layout</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">Layout</span><span class="p">(</span><span class="n">expanded</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">undisplayable_info</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">undisplayable_info</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>


<div class="viewcode-block" id="isoverlay_fn"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.isoverlay_fn">[docs]</a><span class="k">def</span> <span class="nf">isoverlay_fn</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Determines whether object is a DynamicMap returning (Nd)Overlay types.</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">last</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">))</span></div>


<div class="viewcode-block" id="overlay_depth"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.overlay_depth">[docs]</a><span class="k">def</span> <span class="nf">overlay_depth</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Computes the depth of a DynamicMap overlay if it can be determined</span>
<span class="sd">    otherwise return None.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">last</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">last</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">obj</span><span class="o">.</span><span class="n">last</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="compute_overlayable_zorders"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.compute_overlayable_zorders">[docs]</a><span class="k">def</span> <span class="nf">compute_overlayable_zorders</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">"""</span>
<span class="sd">    Traverses an overlayable composite container to determine which</span>
<span class="sd">    objects are associated with specific (Nd)Overlay layers by</span>
<span class="sd">    z-order, making sure to take DynamicMap Callables into</span>
<span class="sd">    account. Returns a mapping between the zorders of each layer and a</span>
<span class="sd">    corresponding lists of objects.</span>

<span class="sd">    Used to determine which overlaid subplots should be linked with</span>
<span class="sd">    Stream callbacks.</span>
<span class="sd">    """</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span>
    <span class="n">zorder_map</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="c1"># Process non-dynamic layers</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">z</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="n">zorder_map</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span><span class="p">,</span> <span class="n">obj</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">HoloMap</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">compute_overlayable_zorders</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">zorder_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">+</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">zorder_map</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">obj</span><span class="p">,</span> <span class="n">el</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">zorder_map</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">zorder_map</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">zorder_map</span>

    <span class="n">isoverlay</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">last</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">)</span>
    <span class="n">isdynoverlay</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">_is_overlay</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">zorder_map</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isoverlay</span><span class="p">:</span>
        <span class="n">zorder_map</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="n">depth</span> <span class="o">=</span> <span class="n">overlay_depth</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="c1"># Process the inputs of the DynamicMap callback</span>
    <span class="n">dmap_inputs</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">inputs</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">link_inputs</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">z</span><span class="p">,</span> <span class="n">inp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dmap_inputs</span><span class="p">):</span>
        <span class="n">no_zorder_increment</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="n">isoverlay_fn</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="ow">or</span> <span class="n">p</span><span class="o">.</span><span class="n">last</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isoverlay_fn</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
            <span class="c1"># If overlay has been collapsed do not increment zorder</span>
            <span class="n">no_zorder_increment</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">input_depth</span> <span class="o">=</span> <span class="n">overlay_depth</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">input_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="n">input_depth</span><span class="p">:</span>
            <span class="c1"># Skips branch of graph where the number of elements in an</span>
            <span class="c1"># overlay has been reduced but still contains more than one layer</span>
            <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_zorder_increment</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Recurse into DynamicMap.callback.inputs and update zorder_map</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="k">if</span> <span class="n">isdynoverlay</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">deep_zorders</span> <span class="o">=</span> <span class="n">compute_overlayable_zorders</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">zorder_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">dz</span><span class="p">,</span> <span class="n">objs</span> <span class="ow">in</span> <span class="n">deep_zorders</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">global_z</span> <span class="o">=</span> <span class="n">offset</span><span class="o">+</span><span class="n">z</span> <span class="k">if</span> <span class="n">no_zorder_increment</span> <span class="k">else</span> <span class="n">offset</span><span class="o">+</span><span class="n">dz</span><span class="o">+</span><span class="n">z</span>
            <span class="n">zorder_map</span><span class="p">[</span><span class="n">global_z</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_iterator</span><span class="p">(</span><span class="n">zorder_map</span><span class="p">[</span><span class="n">global_z</span><span class="p">]</span><span class="o">+</span><span class="n">objs</span><span class="p">))</span>

    <span class="c1"># If object branches but does not declare inputs (e.g. user defined</span>
    <span class="c1"># DynamicMaps returning (Nd)Overlay) add the items on the DynamicMap.last</span>
    <span class="n">found</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">_is_overlay</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">linked</span> <span class="o">=</span>  <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="n">LinkedStream</span><span class="p">,</span> <span class="n">Params</span><span class="p">))</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">linked</span>
                  <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">streams</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">found</span> <span class="ow">or</span> <span class="n">linked</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isoverlay</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isdynoverlay</span><span class="p">:</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">zorder_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">z</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">last</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">isoverlay</span> <span class="ow">and</span> <span class="n">linked</span><span class="p">:</span>
                <span class="n">zorder_map</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="n">z</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">zorder_map</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="n">z</span><span class="p">]:</span>
                <span class="n">zorder_map</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="n">z</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">zorder_map</span></div>


<div class="viewcode-block" id="is_dynamic_overlay"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.is_dynamic_overlay">[docs]</a><span class="k">def</span> <span class="nf">is_dynamic_overlay</span><span class="p">(</span><span class="n">dmap</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Traverses a DynamicMap graph and determines if any components</span>
<span class="sd">    were overlaid dynamically (i.e. by * on a DynamicMap).</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dmap</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">elif</span> <span class="n">dmap</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">_is_overlay</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">is_dynamic_overlay</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span> <span class="k">for</span> <span class="n">dm</span> <span class="ow">in</span> <span class="n">dmap</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span></div>


<div class="viewcode-block" id="split_dmap_overlay"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.split_dmap_overlay">[docs]</a><span class="k">def</span> <span class="nf">split_dmap_overlay</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Splits a DynamicMap into the original component layers it was</span>
<span class="sd">    constructed from by traversing the graph to search for dynamically</span>
<span class="sd">    overlaid components (i.e. constructed by using * on a DynamicMap).</span>
<span class="sd">    Useful for assigning subplots of an OverlayPlot the streams that</span>
<span class="sd">    are responsible for driving their updates. Allows the OverlayPlot</span>
<span class="sd">    to determine if a stream update should redraw a particular</span>
<span class="sd">    subplot.</span>
<span class="sd">    """</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">):</span>
        <span class="n">initialize_dynamic</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">NdOverlay</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">depth</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">Overlay</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">inputs</span> <span class="ow">and</span> <span class="n">is_dynamic_overlay</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">inputs</span><span class="p">:</span>
                    <span class="n">layers</span> <span class="o">+=</span> <span class="n">split_dmap_overlay</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layers</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Overlay</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">layers</span></div>


<div class="viewcode-block" id="initialize_dynamic"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.initialize_dynamic">[docs]</a><span class="k">def</span> <span class="nf">initialize_dynamic</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Initializes all DynamicMap objects contained by the object</span>
<span class="sd">    """</span>
    <span class="n">dmaps</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="p">[</span><span class="n">DynamicMap</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">dmap</span> <span class="ow">in</span> <span class="n">dmaps</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dmap</span><span class="o">.</span><span class="n">unbounded</span><span class="p">:</span>
            <span class="c1"># Skip initialization until plotting code</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">dmap</span><span class="p">):</span>
            <span class="n">dmap</span><span class="p">[</span><span class="n">dmap</span><span class="o">.</span><span class="n">_initial_key</span><span class="p">()]</span></div>


<div class="viewcode-block" id="get_plot_frame"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.get_plot_frame">[docs]</a><span class="k">def</span> <span class="nf">get_plot_frame</span><span class="p">(</span><span class="n">map_obj</span><span class="p">,</span> <span class="n">key_map</span><span class="p">,</span> <span class="n">cached</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""Returns the current frame in a mapping given a key mapping.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: Nested Dimensioned object</span>
<span class="sd">        key_map: Dictionary mapping between dimensions and key value</span>
<span class="sd">        cached: Whether to allow looking up key in cache</span>

<span class="sd">    Returns:</span>
<span class="sd">        The item in the mapping corresponding to the supplied key.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">map_obj</span><span class="o">.</span><span class="n">kdims</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">map_obj</span><span class="o">.</span><span class="n">kdims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">map_obj</span><span class="o">.</span><span class="n">kdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Frame'</span> <span class="ow">and</span>
        <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">map_obj</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">)):</span>
        <span class="c1"># Special handling for static plots</span>
        <span class="k">return</span> <span class="n">map_obj</span><span class="o">.</span><span class="n">last</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">key_map</span><span class="p">[</span><span class="n">kd</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">kd</span> <span class="ow">in</span> <span class="n">map_obj</span><span class="o">.</span><span class="n">kdims</span> <span class="k">if</span> <span class="n">kd</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">key_map</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">map_obj</span><span class="o">.</span><span class="n">data</span> <span class="ow">and</span> <span class="n">cached</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">map_obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">map_obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">StopIteration</span><span class="p">,</span> <span class="n">CallbackError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="get_nested_plot_frame"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.get_nested_plot_frame">[docs]</a><span class="k">def</span> <span class="nf">get_nested_plot_frame</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">key_map</span><span class="p">,</span> <span class="n">cached</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""Extracts a single frame from a nested object.</span>

<span class="sd">    Replaces any HoloMap or DynamicMap in the nested data structure,</span>
<span class="sd">    with the item corresponding to the supplied key.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: Nested Dimensioned object</span>
<span class="sd">        key_map: Dictionary mapping between dimensions and key value</span>
<span class="sd">        cached: Whether to allow looking up key in cache</span>

<span class="sd">    Returns:</span>
<span class="sd">        Nested datastructure where maps are replaced with single frames</span>
<span class="sd">    """</span>
    <span class="n">clone</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># Ensure that DynamicMaps in the cloned frame have</span>
    <span class="c1"># identical callback inputs to allow memoization to work</span>
    <span class="k">for</span> <span class="n">it1</span><span class="p">,</span> <span class="n">it2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">),</span> <span class="n">clone</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it1</span><span class="p">,</span> <span class="n">DynamicMap</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">disable_constant</span><span class="p">(</span><span class="n">it2</span><span class="o">.</span><span class="n">callback</span><span class="p">):</span>
                <span class="n">it2</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">it1</span><span class="o">.</span><span class="n">callback</span><span class="o">.</span><span class="n">inputs</span>
    <span class="k">with</span> <span class="n">item_check</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">clone</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">get_plot_frame</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">key_map</span><span class="p">,</span> <span class="n">cached</span><span class="o">=</span><span class="n">cached</span><span class="p">),</span>
                         <span class="p">[</span><span class="n">DynamicMap</span><span class="p">,</span> <span class="n">HoloMap</span><span class="p">],</span> <span class="n">clone</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="undisplayable_info"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.undisplayable_info">[docs]</a><span class="k">def</span> <span class="nf">undisplayable_info</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="s2">"Generate helpful message regarding an undisplayable object"</span>

    <span class="n">collate</span> <span class="o">=</span> <span class="s1">'&lt;tt&gt;collate&lt;/tt&gt;'</span> <span class="k">if</span> <span class="n">html</span> <span class="k">else</span> <span class="s1">'collate'</span>
    <span class="n">info</span> <span class="o">=</span> <span class="s2">"For more information, please consult the Composing Data tutorial (http://git.io/vtIQh)"</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">HoloMap</span><span class="p">):</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">"HoloMap of </span><span class="si">%s</span><span class="s2"> objects cannot be displayed."</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">remedy</span> <span class="o">=</span> <span class="s2">"Please call the </span><span class="si">%s</span><span class="s2"> method to generate a displayable object"</span> <span class="o">%</span> <span class="n">collate</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Layout</span><span class="p">):</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">"Layout containing HoloMaps of Layout or GridSpace objects cannot be displayed."</span>
        <span class="n">remedy</span> <span class="o">=</span> <span class="s2">"Please call the </span><span class="si">%s</span><span class="s2"> method on the appropriate elements."</span> <span class="o">%</span> <span class="n">collate</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">GridSpace</span><span class="p">):</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">"GridSpace containing HoloMaps of Layouts cannot be displayed."</span>
        <span class="n">remedy</span> <span class="o">=</span> <span class="s2">"Please call the </span><span class="si">%s</span><span class="s2"> method on the appropriate elements."</span> <span class="o">%</span> <span class="n">collate</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">html</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">error</span><span class="p">,</span> <span class="n">remedy</span><span class="p">,</span> <span class="n">info</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">"&lt;center&gt;</span><span class="si">{msg}</span><span class="s2">&lt;/center&gt;"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="p">(</span><span class="s1">'&lt;br&gt;'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span><span class="s1">'&lt;b&gt;</span><span class="si">%s</span><span class="s1">&lt;/b&gt;'</span> <span class="o">%</span> <span class="n">error</span><span class="p">,</span> <span class="n">remedy</span><span class="p">,</span> <span class="s1">'&lt;i&gt;</span><span class="si">%s</span><span class="s1">&lt;/i&gt;'</span> <span class="o">%</span> <span class="n">info</span><span class="p">])))</span></div>


<div class="viewcode-block" id="compute_sizes"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.compute_sizes">[docs]</a><span class="k">def</span> <span class="nf">compute_sizes</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">size_fn</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="p">,</span> <span class="n">scaling_method</span><span class="p">,</span> <span class="n">base_size</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Scales point sizes according to a scaling factor,</span>
<span class="sd">    base size and size_fn, which will be applied before</span>
<span class="sd">    scaling.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">sizes</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">'i'</span><span class="p">,</span> <span class="s1">'f'</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">scaling_method</span> <span class="o">==</span> <span class="s1">'area'</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">scaling_method</span> <span class="o">==</span> <span class="s1">'width'</span><span class="p">:</span>
        <span class="n">scaling_factor</span> <span class="o">=</span> <span class="n">scaling_factor</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">'Invalid value for argument "scaling_method": "</span><span class="si">{}</span><span class="s1">". '</span>
            <span class="s1">'Valid values are: "width", "area".'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scaling_method</span><span class="p">))</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="n">size_fn</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">base_size</span><span class="o">*</span><span class="n">scaling_factor</span><span class="o">*</span><span class="n">sizes</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_axis_padding"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.get_axis_padding">[docs]</a><span class="k">def</span> <span class="nf">get_axis_padding</span><span class="p">(</span><span class="n">padding</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Process a padding value supplied as a tuple or number and returns</span>
<span class="sd">    padding values for x-, y- and z-axis.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">xpad</span><span class="p">,</span> <span class="n">ypad</span> <span class="o">=</span> <span class="n">padding</span>
            <span class="n">zpad</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">xpad</span><span class="p">,</span> <span class="n">ypad</span><span class="p">,</span> <span class="n">zpad</span> <span class="o">=</span> <span class="n">padding</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Padding must be supplied as an number applied '</span>
                             <span class="s1">'to all axes or a length two or three tuple '</span>
                             <span class="s1">'corresponding to the x-, y- and optionally z-axis'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">xpad</span><span class="p">,</span> <span class="n">ypad</span><span class="p">,</span> <span class="n">zpad</span> <span class="o">=</span> <span class="p">(</span><span class="n">padding</span><span class="p">,)</span><span class="o">*</span><span class="mi">3</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xpad</span><span class="p">,</span> <span class="n">ypad</span><span class="p">,</span> <span class="n">zpad</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_minimum_span"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.get_minimum_span">[docs]</a><span class="k">def</span> <span class="nf">get_minimum_span</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">span</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    If lower and high values are equal ensures they are separated by</span>
<span class="sd">    the defined span.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">is_number</span><span class="p">(</span><span class="n">low</span><span class="p">)</span> <span class="ow">and</span> <span class="n">low</span> <span class="o">==</span> <span class="n">high</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
            <span class="n">span</span> <span class="o">=</span> <span class="n">span</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'s'</span><span class="p">)</span>
        <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="n">low</span><span class="o">-</span><span class="n">span</span><span class="p">,</span> <span class="n">high</span><span class="o">+</span><span class="n">span</span>
    <span class="k">return</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span></div>


<div class="viewcode-block" id="get_range"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.get_range">[docs]</a><span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">ranges</span><span class="p">,</span> <span class="n">dimension</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Computes the data, soft- and hard-range along a dimension given</span>
<span class="sd">    an element and a dictionary of ranges.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">dimension</span> <span class="ow">and</span> <span class="n">dimension</span> <span class="o">!=</span> <span class="s1">'categorical'</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ranges</span> <span class="ow">and</span> <span class="n">dimension</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">ranges</span><span class="p">:</span>
            <span class="n">drange</span> <span class="o">=</span> <span class="n">ranges</span><span class="p">[</span><span class="n">dimension</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">'data'</span><span class="p">]</span>
            <span class="n">srange</span> <span class="o">=</span> <span class="n">ranges</span><span class="p">[</span><span class="n">dimension</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">'soft'</span><span class="p">]</span>
            <span class="n">hrange</span> <span class="o">=</span> <span class="n">ranges</span><span class="p">[</span><span class="n">dimension</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">'hard'</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">drange</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">dimension_range</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">srange</span> <span class="o">=</span> <span class="n">dimension</span><span class="o">.</span><span class="n">soft_range</span>
            <span class="n">hrange</span> <span class="o">=</span> <span class="n">dimension</span><span class="o">.</span><span class="n">range</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">drange</span> <span class="o">=</span> <span class="n">srange</span> <span class="o">=</span> <span class="n">hrange</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">drange</span><span class="p">,</span> <span class="n">srange</span><span class="p">,</span> <span class="n">hrange</span></div>


<div class="viewcode-block" id="get_sideplot_ranges"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.get_sideplot_ranges">[docs]</a><span class="k">def</span> <span class="nf">get_sideplot_ranges</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">main</span><span class="p">,</span> <span class="n">ranges</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Utility to find the range for an adjoined</span>
<span class="sd">    plot given the plot, the element, the</span>
<span class="sd">    Element the plot is adjoined to and the</span>
<span class="sd">    dictionary of ranges.</span>
<span class="sd">    """</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">current_key</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">dimensions</span><span class="p">()</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s1">'frequency'</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s1">'count'</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">else</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">range_item</span> <span class="o">=</span> <span class="n">main</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">main</span><span class="p">,</span> <span class="n">HoloMap</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">main</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">):</span>
            <span class="n">range_item</span> <span class="o">=</span> <span class="p">[</span><span class="n">hm</span> <span class="k">for</span> <span class="n">hm</span> <span class="ow">in</span> <span class="n">main</span><span class="o">.</span><span class="n">_split_overlays</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                          <span class="k">if</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">hm</span><span class="o">.</span><span class="n">dimensions</span><span class="p">(</span><span class="s1">'all'</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">range_item</span> <span class="o">=</span> <span class="n">HoloMap</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">main</span><span class="p">},</span> <span class="n">kdims</span><span class="o">=</span><span class="p">[</span><span class="s1">'Frame'</span><span class="p">])</span>
        <span class="n">ranges</span> <span class="o">=</span> <span class="n">match_spec</span><span class="p">(</span><span class="n">range_item</span><span class="o">.</span><span class="n">last</span><span class="p">,</span> <span class="n">ranges</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dim</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">ranges</span><span class="p">:</span>
        <span class="n">main_range</span> <span class="o">=</span> <span class="n">ranges</span><span class="p">[</span><span class="n">dim</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">'combined'</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">framewise</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">lookup_options</span><span class="p">(</span><span class="n">range_item</span><span class="o">.</span><span class="n">last</span><span class="p">,</span> <span class="s1">'norm'</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'framewise'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">framewise</span> <span class="ow">and</span> <span class="n">range_item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">main_range</span> <span class="o">=</span> <span class="n">range_item</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">main_range</span> <span class="o">=</span> <span class="n">range_item</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>

    <span class="c1"># If .main is an NdOverlay or a HoloMap of Overlays get the correct style</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">range_item</span><span class="p">,</span> <span class="n">HoloMap</span><span class="p">):</span>
        <span class="n">range_item</span> <span class="o">=</span> <span class="n">range_item</span><span class="o">.</span><span class="n">last</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">range_item</span><span class="p">,</span> <span class="n">CompositeOverlay</span><span class="p">):</span>
        <span class="n">range_item</span> <span class="o">=</span> <span class="p">[</span><span class="n">ov</span> <span class="k">for</span> <span class="n">ov</span> <span class="ow">in</span> <span class="n">range_item</span>
                      <span class="k">if</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">ov</span><span class="o">.</span><span class="n">dimensions</span><span class="p">(</span><span class="s1">'all'</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">range_item</span><span class="p">,</span> <span class="n">main_range</span><span class="p">,</span> <span class="n">dim</span></div>


<div class="viewcode-block" id="within_range"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.within_range">[docs]</a><span class="k">def</span> <span class="nf">within_range</span><span class="p">(</span><span class="n">range1</span><span class="p">,</span> <span class="n">range2</span><span class="p">):</span>
    <span class="sd">"""Checks whether range1 is within the range specified by range2."""</span>
    <span class="n">range1</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">if</span> <span class="n">isfinite</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">range1</span><span class="p">]</span>
    <span class="n">range2</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">if</span> <span class="n">isfinite</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">range2</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">range1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">range2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">range1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">range2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span>
            <span class="p">(</span><span class="n">range1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">range2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">range1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">range2</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>


<span class="k">def</span> <span class="nf">validate_unbounded_mode</span><span class="p">(</span><span class="n">holomaps</span><span class="p">,</span> <span class="n">dynmaps</span><span class="p">):</span>
    <span class="n">composite</span> <span class="o">=</span> <span class="n">HoloMap</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">holomaps</span><span class="p">),</span> <span class="n">kdims</span><span class="o">=</span><span class="p">[</span><span class="s1">'testing_kdim'</span><span class="p">])</span>
    <span class="n">holomap_kdims</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">unique_iterator</span><span class="p">([</span><span class="n">kd</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">dm</span> <span class="ow">in</span> <span class="n">holomaps</span> <span class="k">for</span> <span class="n">kd</span> <span class="ow">in</span> <span class="n">dm</span><span class="o">.</span><span class="n">kdims</span><span class="p">]))</span>
    <span class="n">hmranges</span> <span class="o">=</span> <span class="p">{</span><span class="n">d</span><span class="p">:</span> <span class="n">composite</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">holomap_kdims</span><span class="p">}</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dm</span><span class="o">.</span><span class="n">kdims</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">holomap_kdims</span>
                        <span class="k">for</span> <span class="n">dm</span> <span class="ow">in</span> <span class="n">dynmaps</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">'DynamicMap that are unbounded must have key dimensions that are a '</span>
                        <span class="s1">'subset of dimensions of the HoloMap(s) defining the keys.'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">within_range</span><span class="p">(</span><span class="n">hmrange</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="k">for</span> <span class="n">dm</span> <span class="ow">in</span> <span class="n">dynmaps</span>
                              <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">hmrange</span> <span class="ow">in</span> <span class="n">hmranges</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dm</span><span class="o">.</span><span class="n">kdims</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">'HoloMap(s) have keys outside the ranges specified on '</span>
                        <span class="s1">'the DynamicMap(s).'</span><span class="p">)</span>


<div class="viewcode-block" id="get_dynamic_mode"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.get_dynamic_mode">[docs]</a><span class="k">def</span> <span class="nf">get_dynamic_mode</span><span class="p">(</span><span class="n">composite</span><span class="p">):</span>
    <span class="s2">"Returns the common mode of the dynamic maps in given composite object"</span>
    <span class="n">dynmaps</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">DynamicMap</span><span class="p">])</span>
    <span class="n">holomaps</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="s1">'HoloMap'</span><span class="p">])</span>
    <span class="n">dynamic_unbounded</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">unbounded</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">dynmaps</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">holomaps</span><span class="p">:</span>
        <span class="n">validate_unbounded_mode</span><span class="p">(</span><span class="n">holomaps</span><span class="p">,</span> <span class="n">dynmaps</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dynamic_unbounded</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">holomaps</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"DynamicMaps in unbounded mode must be displayed alongside "</span>
                        <span class="s2">"a HoloMap to define the sampling."</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dynmaps</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">holomaps</span><span class="p">,</span> <span class="n">dynamic_unbounded</span></div>


<div class="viewcode-block" id="initialize_unbounded"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.initialize_unbounded">[docs]</a><span class="k">def</span> <span class="nf">initialize_unbounded</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Initializes any DynamicMaps in unbounded mode.</span>
<span class="sd">    """</span>
    <span class="n">select</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">],</span> <span class="n">key</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">selection_specs</span><span class="o">=</span><span class="p">[</span><span class="n">DynamicMap</span><span class="p">],</span> <span class="o">**</span><span class="n">select</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="dynamic_update"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.dynamic_update">[docs]</a><span class="k">def</span> <span class="nf">dynamic_update</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">subplot</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">overlay</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Given a plot, subplot and dynamically generated (Nd)Overlay</span>
<span class="sd">    find the closest matching Element for that plot.</span>
<span class="sd">    """</span>
    <span class="n">match_spec</span> <span class="o">=</span> <span class="n">get_overlay_spec</span><span class="p">(</span><span class="n">overlay</span><span class="p">,</span>
                                  <span class="n">wrap_tuple</span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
                                  <span class="n">subplot</span><span class="o">.</span><span class="n">current_frame</span><span class="p">)</span>
    <span class="n">specs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">get_overlay_spec</span><span class="p">(</span><span class="n">overlay</span><span class="p">,</span> <span class="n">wrap_tuple</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">el</span><span class="p">))</span>
             <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">)]</span>
    <span class="n">closest</span> <span class="o">=</span> <span class="n">closest_match</span><span class="p">(</span><span class="n">match_spec</span><span class="p">,</span> <span class="n">specs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">closest</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">closest</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span>
    <span class="n">matched</span> <span class="o">=</span> <span class="n">specs</span><span class="p">[</span><span class="n">closest</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">closest</span><span class="p">,</span> <span class="n">matched</span><span class="p">,</span> <span class="n">match_spec</span> <span class="o">==</span> <span class="n">matched</span></div>


<div class="viewcode-block" id="map_colors"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.map_colors">[docs]</a><span class="k">def</span> <span class="nf">map_colors</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">crange</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="nb">hex</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Maps an array of values to RGB hex strings, given</span>
<span class="sd">    a color range and colormap.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crange</span><span class="p">,</span> <span class="n">arraylike_types</span><span class="p">):</span>
        <span class="n">xsorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">crange</span><span class="p">)</span>
        <span class="n">ypos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">crange</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">xsorted</span><span class="p">[</span><span class="n">ypos</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crange</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="n">crange</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span> <span class="o">-</span> <span class="n">cmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">cmax</span><span class="o">-</span><span class="n">cmin</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">arr</span><span class="p">)))</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hex</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rgb2hex</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">arr</span></div>


<div class="viewcode-block" id="resample_palette"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.resample_palette">[docs]</a><span class="k">def</span> <span class="nf">resample_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">,</span> <span class="n">categorical</span><span class="p">,</span> <span class="n">cmap_categorical</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Resample the number of colors in a palette to the selected number.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ncolors</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">categorical</span> <span class="ow">and</span> <span class="n">cmap_categorical</span><span class="p">:</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="n">palette</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncolors</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lpad</span><span class="p">,</span> <span class="n">rpad</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.49999999999</span>
            <span class="n">indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lpad</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">rpad</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">)</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="n">palette</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">palette</span></div>


<div class="viewcode-block" id="mplcmap_to_palette"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.mplcmap_to_palette">[docs]</a><span class="k">def</span> <span class="nf">mplcmap_to_palette</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Converts a matplotlib colormap to palette of RGB hex strings."</span>
<span class="sd">    """</span>
    <span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">Colormap</span><span class="p">,</span> <span class="n">ListedColormap</span>

    <span class="n">ncolors</span> <span class="o">=</span> <span class="n">ncolors</span> <span class="ow">or</span> <span class="mi">256</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">Colormap</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
        <span class="c1"># Alias bokeh Category cmaps with mpl tab cmaps</span>
        <span class="k">if</span> <span class="n">cmap</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">'Category'</span><span class="p">):</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'Category'</span><span class="p">,</span> <span class="s1">'tab'</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ListedColormap</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">categorical</span><span class="p">:</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncolors</span><span class="p">)]</span>
            <span class="k">return</span> <span class="n">palette</span>
        <span class="k">elif</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span> <span class="o">&gt;</span> <span class="n">ncolors</span><span class="p">:</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">))]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ncolors</span><span class="p">:</span>
                <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="n">palette</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">)]</span>
            <span class="k">return</span> <span class="n">palette</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">))]</span></div>


<span class="k">def</span> <span class="nf">colorcet_cmap_to_palette</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">colorcet</span> <span class="kn">import</span> <span class="n">palette</span>

    <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'glasbey'</span><span class="p">]</span>

    <span class="n">ncolors</span> <span class="o">=</span> <span class="n">ncolors</span> <span class="ow">or</span> <span class="mi">256</span>
    <span class="n">cmap_categorical</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="ow">in</span> <span class="n">cmap</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cmap</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'_r'</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">palette</span><span class="p">[</span><span class="n">cmap</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="n">cmap</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">resample_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">,</span> <span class="n">categorical</span><span class="p">,</span> <span class="n">cmap_categorical</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">bokeh_palette_to_palette</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">bokeh</span> <span class="kn">import</span> <span class="n">palettes</span>

    <span class="c1"># Handle categorical colormaps to avoid interpolation</span>
    <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'accent'</span><span class="p">,</span> <span class="s1">'category'</span><span class="p">,</span> <span class="s1">'dark'</span><span class="p">,</span> <span class="s1">'colorblind'</span><span class="p">,</span> <span class="s1">'pastel'</span><span class="p">,</span>
                  <span class="s1">'set1'</span><span class="p">,</span> <span class="s1">'set2'</span><span class="p">,</span> <span class="s1">'set3'</span><span class="p">,</span> <span class="s1">'paired'</span><span class="p">]</span>
    <span class="n">cmap_categorical</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">cat</span> <span class="ow">in</span> <span class="n">cmap</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">)</span>
    <span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">cmap</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'_r'</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Some colormaps are inverted compared to matplotlib</span>
    <span class="n">inverted</span> <span class="o">=</span> <span class="p">(</span><span class="ow">not</span> <span class="n">cmap_categorical</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cmap</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="ow">in</span> <span class="n">palettes</span><span class="o">.</span><span class="n">mpl</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">cmap</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">'fire'</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">inverted</span><span class="p">:</span>
        <span class="n">reverse</span><span class="o">=</span><span class="ow">not</span> <span class="n">reverse</span>
    <span class="n">ncolors</span> <span class="o">=</span> <span class="n">ncolors</span> <span class="ow">or</span> <span class="mi">256</span>

    <span class="c1"># Alias mpl tab cmaps with bokeh Category cmaps</span>
    <span class="k">if</span> <span class="n">cmap</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">'tab'</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'tab'</span><span class="p">,</span> <span class="s1">'Category'</span><span class="p">)</span>

    <span class="c1"># Process as bokeh palette</span>
    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="n">palettes</span><span class="o">.</span><span class="n">all_palettes</span><span class="p">:</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">palettes</span><span class="o">.</span><span class="n">all_palettes</span><span class="p">[</span><span class="n">cmap</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">palettes</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">palettes</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span> <span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">palette</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Supplied palette </span><span class="si">%s</span><span class="s2"> not found among bokeh palettes"</span> <span class="o">%</span> <span class="n">cmap</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cmap</span> <span class="ow">in</span> <span class="n">palette</span> <span class="ow">or</span> <span class="n">cmap</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="ow">in</span> <span class="n">palette</span><span class="p">):</span>
        <span class="c1"># Some bokeh palettes are doubly nested</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">palette</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">palette</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()))</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">palette</span><span class="p">)]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cmap_categorical</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ncolors</span><span class="p">:</span>
                <span class="n">palette</span> <span class="o">=</span> <span class="n">polylinear_gradient</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">palette</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">palette</span><span class="p">(</span><span class="n">ncolors</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span> <span class="n">palette</span> <span class="o">=</span> <span class="n">palette</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">resample_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">,</span> <span class="n">categorical</span><span class="p">,</span> <span class="n">cmap_categorical</span><span class="p">))</span>


<div class="viewcode-block" id="linear_gradient"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.linear_gradient">[docs]</a><span class="k">def</span> <span class="nf">linear_gradient</span><span class="p">(</span><span class="n">start_hex</span><span class="p">,</span> <span class="n">finish_hex</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Interpolates the color gradient between to hex colors</span>
<span class="sd">    """</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">hex2rgb</span><span class="p">(</span><span class="n">start_hex</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">hex2rgb</span><span class="p">(</span><span class="n">finish_hex</span><span class="p">)</span>
    <span class="n">gradient</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">curr_vector</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_vector</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">rgb2hex</span><span class="p">([</span><span class="n">c</span><span class="o">/</span><span class="mf">255.</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">rgb</span><span class="p">])</span> <span class="k">for</span> <span class="n">rgb</span> <span class="ow">in</span> <span class="n">gradient</span><span class="p">]</span></div>


<div class="viewcode-block" id="polylinear_gradient"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.polylinear_gradient">[docs]</a><span class="k">def</span> <span class="nf">polylinear_gradient</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Interpolates the color gradients between a list of hex colors.</span>
<span class="sd">    """</span>
    <span class="n">n_out</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">gradient</span> <span class="o">=</span> <span class="n">linear_gradient</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_out</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">gradient</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">gradient</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">next_colors</span> <span class="o">=</span> <span class="n">linear_gradient</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="n">col</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_out</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">gradient</span> <span class="o">+=</span> <span class="n">next_colors</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">next_colors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">next_colors</span>
    <span class="k">return</span> <span class="n">gradient</span></div>


<span class="n">cmap_info</span><span class="o">=</span><span class="p">[]</span>
<span class="n">CMapInfo</span><span class="o">=</span><span class="n">namedtuple</span><span class="p">(</span><span class="s1">'CMapInfo'</span><span class="p">,[</span><span class="s1">'name'</span><span class="p">,</span><span class="s1">'provider'</span><span class="p">,</span><span class="s1">'category'</span><span class="p">,</span><span class="s1">'source'</span><span class="p">,</span><span class="s1">'bg'</span><span class="p">])</span>
<span class="n">providers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'bokeh'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_list_cmaps</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">records</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    List available colormaps by combining matplotlib, bokeh, and</span>
<span class="sd">    colorcet colormaps or palettes if available. May also be</span>
<span class="sd">    narrowed down to a particular provider or list of providers.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">provider</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">provider</span> <span class="o">=</span> <span class="n">providers</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">provider</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">provider</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">providers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Colormap provider </span><span class="si">%r</span><span class="s1"> not recognized, must '</span>
                             <span class="s1">'be one of </span><span class="si">%r</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">provider</span><span class="p">,</span> <span class="n">providers</span><span class="p">))</span>
        <span class="n">provider</span> <span class="o">=</span> <span class="p">[</span><span class="n">provider</span><span class="p">]</span>

    <span class="n">cmaps</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">provider</span><span class="p">,</span><span class="n">names</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">CMapInfo</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">provider</span><span class="o">=</span><span class="n">provider</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span> \
               <span class="k">if</span> <span class="n">records</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">'matplotlib'</span> <span class="ow">in</span> <span class="n">provider</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="s1">'_cmap_registry'</span><span class="p">):</span>
                <span class="n">mpl_cmaps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">_cmap_registry</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mpl_cmaps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">cmaps_listed</span><span class="p">)</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">datad</span><span class="p">)</span>
            <span class="n">cmaps</span> <span class="o">+=</span> <span class="n">info</span><span class="p">(</span><span class="s1">'matplotlib'</span><span class="p">,</span> <span class="n">mpl_cmaps</span><span class="p">)</span>
            <span class="n">cmaps</span> <span class="o">+=</span> <span class="n">info</span><span class="p">(</span><span class="s1">'matplotlib'</span><span class="p">,</span> <span class="p">[</span><span class="n">cmap</span><span class="o">+</span><span class="s1">'_r'</span> <span class="k">for</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="n">mpl_cmaps</span>
                                         <span class="k">if</span> <span class="ow">not</span> <span class="n">cmap</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'_r'</span><span class="p">)])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">if</span> <span class="s1">'bokeh'</span> <span class="ow">in</span> <span class="n">provider</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">bokeh</span> <span class="kn">import</span> <span class="n">palettes</span>
            <span class="n">cmaps</span> <span class="o">+=</span> <span class="n">info</span><span class="p">(</span><span class="s1">'bokeh'</span><span class="p">,</span> <span class="n">palettes</span><span class="o">.</span><span class="n">all_palettes</span><span class="p">)</span>
            <span class="n">cmaps</span> <span class="o">+=</span> <span class="n">info</span><span class="p">(</span><span class="s1">'bokeh'</span><span class="p">,</span> <span class="p">[</span><span class="n">p</span><span class="o">+</span><span class="s1">'_r'</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palettes</span><span class="o">.</span><span class="n">all_palettes</span>
                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'_r'</span><span class="p">)])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">if</span> <span class="s1">'colorcet'</span> <span class="ow">in</span> <span class="n">provider</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">colorcet</span> <span class="kn">import</span> <span class="n">palette_n</span><span class="p">,</span> <span class="n">glasbey_hv</span>
            <span class="n">cet_maps</span> <span class="o">=</span> <span class="n">palette_n</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">cet_maps</span><span class="p">[</span><span class="s1">'glasbey_hv'</span><span class="p">]</span> <span class="o">=</span> <span class="n">glasbey_hv</span> <span class="c1"># Add special hv-specific map</span>
            <span class="n">cmaps</span> <span class="o">+=</span> <span class="n">info</span><span class="p">(</span><span class="s1">'colorcet'</span><span class="p">,</span> <span class="n">cet_maps</span><span class="p">)</span>
            <span class="n">cmaps</span> <span class="o">+=</span> <span class="n">info</span><span class="p">(</span><span class="s1">'colorcet'</span><span class="p">,</span> <span class="p">[</span><span class="n">p</span><span class="o">+</span><span class="s1">'_r'</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">cet_maps</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'_r'</span><span class="p">)])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">unique_iterator</span><span class="p">(</span><span class="n">cmaps</span><span class="p">))</span>


<div class="viewcode-block" id="register_cmaps"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.register_cmaps">[docs]</a><span class="k">def</span> <span class="nf">register_cmaps</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">provider</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">bg</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Maintain descriptions of colormaps that include the following information:</span>

<span class="sd">    name     - string name for the colormap</span>
<span class="sd">    category - intended use or purpose, mostly following matplotlib</span>
<span class="sd">    provider - package providing the colormap directly</span>
<span class="sd">    source   - original source or creator of the colormaps</span>
<span class="sd">    bg       - base/background color expected for the map</span>
<span class="sd">               ('light','dark','medium','any' (unknown or N/A))</span>
<span class="sd">    """</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="n">bisect</span><span class="o">.</span><span class="n">insort</span><span class="p">(</span><span class="n">cmap_info</span><span class="p">,</span> <span class="n">CMapInfo</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">provider</span><span class="o">=</span><span class="n">provider</span><span class="p">,</span>
                                          <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
                                          <span class="n">bg</span><span class="o">=</span><span class="n">bg</span><span class="p">))</span></div>


<div class="viewcode-block" id="list_cmaps"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.list_cmaps">[docs]</a><span class="k">def</span> <span class="nf">list_cmaps</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">records</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">bg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Return colormap names matching the specified filters.</span>
<span class="sd">    """</span>
    <span class="c1"># Only uses names actually imported and currently available</span>
    <span class="n">available</span> <span class="o">=</span> <span class="n">_list_cmaps</span><span class="p">(</span><span class="n">provider</span><span class="o">=</span><span class="n">provider</span><span class="p">,</span> <span class="n">records</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">avail</span> <span class="ow">in</span> <span class="n">available</span><span class="p">:</span>
        <span class="n">aname</span><span class="o">=</span><span class="n">avail</span><span class="o">.</span><span class="n">name</span>
        <span class="n">matched</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">basename</span><span class="o">=</span><span class="n">aname</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">aname</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'_r'</span><span class="p">)</span> <span class="k">else</span> <span class="n">aname</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">reverse</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
            <span class="p">(</span><span class="n">reverse</span><span class="o">==</span><span class="kc">True</span> <span class="ow">and</span> <span class="n">aname</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'_r'</span><span class="p">))</span> <span class="ow">or</span>
            <span class="p">(</span><span class="n">reverse</span><span class="o">==</span><span class="kc">False</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">aname</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'_r'</span><span class="p">))):</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">cmap_info</span><span class="p">:</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="n">basename</span><span class="p">):</span>
                   <span class="n">matched</span><span class="o">=</span><span class="kc">True</span>

                   <span class="c1"># cmap_info stores only non-reversed info, so construct</span>
                   <span class="c1"># suitable values for reversed version if appropriate</span>
                   <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">aname</span><span class="p">)</span>
                   <span class="k">if</span> <span class="n">aname</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'_r'</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">category</span> <span class="o">!=</span> <span class="s1">'Diverging'</span><span class="p">):</span>
                       <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">bg</span><span class="o">==</span><span class="s1">'light'</span><span class="p">:</span>
                           <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s1">'dark'</span><span class="p">)</span>
                       <span class="k">elif</span> <span class="n">r</span><span class="o">.</span><span class="n">bg</span><span class="o">==</span><span class="s1">'dark'</span><span class="p">:</span>
                           <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s1">'light'</span><span class="p">)</span>

                   <span class="k">if</span> <span class="p">((</span>    <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>     <span class="n">name</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span>
                       <span class="p">(</span><span class="n">provider</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">provider</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">provider</span><span class="p">)</span> <span class="ow">and</span>
                       <span class="p">(</span><span class="n">category</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">category</span><span class="p">)</span> <span class="ow">and</span>
                       <span class="p">(</span>  <span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>   <span class="n">source</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="ow">and</span>
                       <span class="p">(</span>      <span class="n">bg</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>       <span class="n">bg</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">bg</span><span class="p">)):</span>
                       <span class="n">matches</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span> <span class="ow">and</span> <span class="p">(</span><span class="n">category</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">category</span><span class="o">==</span><span class="s1">'Miscellaneous'</span><span class="p">):</span>
                <span class="c1"># Return colormaps that exist but are not found in cmap_info</span>
                <span class="c1"># under the 'Miscellaneous' category, with no source or bg</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">CMapInfo</span><span class="p">(</span><span class="n">aname</span><span class="p">,</span><span class="n">provider</span><span class="o">=</span><span class="n">avail</span><span class="o">.</span><span class="n">provider</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">'Miscellaneous'</span><span class="p">,</span><span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">bg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">matches</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

    <span class="c1"># Return results sorted by category if category information is provided</span>
    <span class="k">if</span> <span class="n">records</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_iterator</span><span class="p">(</span><span class="n">python2sort</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span>
                    <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">r</span><span class="o">.</span><span class="n">bg</span><span class="p">,</span><span class="n">r</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span><span class="n">r</span><span class="o">.</span><span class="n">provider</span><span class="p">,</span><span class="n">r</span><span class="o">.</span><span class="n">source</span><span class="p">))))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_iterator</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([</span><span class="n">rec</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span><span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">())))</span></div>


<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Sequential'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'bids'</span><span class="p">,</span> <span class="s1">'dark'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'viridis'</span><span class="p">,</span> <span class="s1">'plasma'</span><span class="p">,</span> <span class="s1">'inferno'</span><span class="p">,</span> <span class="s1">'magma'</span><span class="p">,</span> <span class="s1">'cividis'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Mono Sequential'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'colorbrewer'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'Greys'</span><span class="p">,</span> <span class="s1">'Purples'</span><span class="p">,</span> <span class="s1">'Blues'</span><span class="p">,</span> <span class="s1">'Greens'</span><span class="p">,</span> <span class="s1">'Oranges'</span><span class="p">,</span> <span class="s1">'Reds'</span><span class="p">,</span>
     <span class="s1">'YlOrBr'</span><span class="p">,</span> <span class="s1">'YlOrRd'</span><span class="p">,</span> <span class="s1">'OrRd'</span><span class="p">,</span> <span class="s1">'PuRd'</span><span class="p">,</span> <span class="s1">'RdPu'</span><span class="p">,</span> <span class="s1">'BuPu'</span><span class="p">,</span>
     <span class="s1">'GnBu'</span><span class="p">,</span> <span class="s1">'PuBu'</span><span class="p">,</span> <span class="s1">'YlGnBu'</span><span class="p">,</span> <span class="s1">'PuBuGn'</span><span class="p">,</span> <span class="s1">'BuGn'</span><span class="p">,</span> <span class="s1">'YlGn'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Other Sequential'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'misc'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'gist_yarg'</span><span class="p">,</span> <span class="s1">'binary'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Other Sequential'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'misc'</span><span class="p">,</span> <span class="s1">'dark'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'afmhot'</span><span class="p">,</span> <span class="s1">'gray'</span><span class="p">,</span> <span class="s1">'bone'</span><span class="p">,</span> <span class="s1">'gist_gray'</span><span class="p">,</span> <span class="s1">'gist_heat'</span><span class="p">,</span>
     <span class="s1">'hot'</span><span class="p">,</span> <span class="s1">'pink'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Other Sequential'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'misc'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'copper'</span><span class="p">,</span> <span class="s1">'spring'</span><span class="p">,</span> <span class="s1">'summer'</span><span class="p">,</span> <span class="s1">'autumn'</span><span class="p">,</span> <span class="s1">'winter'</span><span class="p">,</span> <span class="s1">'cool'</span><span class="p">,</span> <span class="s1">'Wistia'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Diverging'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'colorbrewer'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'BrBG'</span><span class="p">,</span> <span class="s1">'PiYG'</span><span class="p">,</span> <span class="s1">'PRGn'</span><span class="p">,</span> <span class="s1">'PuOr'</span><span class="p">,</span> <span class="s1">'RdBu'</span><span class="p">,</span> <span class="s1">'RdGy'</span><span class="p">,</span>
     <span class="s1">'RdYlBu'</span><span class="p">,</span> <span class="s1">'RdYlGn'</span><span class="p">,</span> <span class="s1">'Spectral'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Diverging'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'misc'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'coolwarm'</span><span class="p">,</span> <span class="s1">'bwr'</span><span class="p">,</span> <span class="s1">'seismic'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Categorical'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'colorbrewer'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'Accent'</span><span class="p">,</span> <span class="s1">'Dark2'</span><span class="p">,</span> <span class="s1">'Paired'</span><span class="p">,</span> <span class="s1">'Pastel1'</span><span class="p">,</span> <span class="s1">'Pastel2'</span><span class="p">,</span>
     <span class="s1">'Set1'</span><span class="p">,</span> <span class="s1">'Set2'</span><span class="p">,</span> <span class="s1">'Set3'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Categorical'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'d3'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'tab10'</span><span class="p">,</span> <span class="s1">'tab20'</span><span class="p">,</span> <span class="s1">'tab20b'</span><span class="p">,</span> <span class="s1">'tab20c'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Rainbow'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'misc'</span><span class="p">,</span> <span class="s1">'dark'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'nipy_spectral'</span><span class="p">,</span> <span class="s1">'gist_ncar'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Rainbow'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'misc'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'brg'</span><span class="p">,</span> <span class="s1">'hsv'</span><span class="p">,</span> <span class="s1">'gist_rainbow'</span><span class="p">,</span> <span class="s1">'rainbow'</span><span class="p">,</span> <span class="s1">'jet'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Miscellaneous'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'misc'</span><span class="p">,</span> <span class="s1">'dark'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'CMRmap'</span><span class="p">,</span> <span class="s1">'cubehelix'</span><span class="p">,</span> <span class="s1">'gist_earth'</span><span class="p">,</span> <span class="s1">'gist_stern'</span><span class="p">,</span>
     <span class="s1">'gnuplot'</span><span class="p">,</span> <span class="s1">'gnuplot2'</span><span class="p">,</span> <span class="s1">'ocean'</span><span class="p">,</span> <span class="s1">'terrain'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Miscellaneous'</span><span class="p">,</span> <span class="s1">'matplotlib'</span><span class="p">,</span> <span class="s1">'misc'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'flag'</span><span class="p">,</span> <span class="s1">'prism'</span><span class="p">])</span>


<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Sequential'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">,</span> <span class="s1">'cet'</span><span class="p">,</span> <span class="s1">'dark'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'bgyw'</span><span class="p">,</span> <span class="s1">'bgy'</span><span class="p">,</span> <span class="s1">'kbc'</span><span class="p">,</span> <span class="s1">'bmw'</span><span class="p">,</span> <span class="s1">'bmy'</span><span class="p">,</span> <span class="s1">'kgy'</span><span class="p">,</span> <span class="s1">'gray'</span><span class="p">,</span>
     <span class="s1">'dimgray'</span><span class="p">,</span> <span class="s1">'fire'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Sequential'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">,</span> <span class="s1">'cet'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'blues'</span><span class="p">,</span> <span class="s1">'kr'</span><span class="p">,</span> <span class="s1">'kg'</span><span class="p">,</span> <span class="s1">'kb'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Diverging'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">,</span> <span class="s1">'cet'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'coolwarm'</span><span class="p">,</span> <span class="s1">'gwv'</span><span class="p">,</span> <span class="s1">'bwy'</span><span class="p">,</span> <span class="s1">'cwr'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Diverging'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">,</span> <span class="s1">'cet'</span><span class="p">,</span> <span class="s1">'dark'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'bkr'</span><span class="p">,</span> <span class="s1">'bky'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Diverging'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">,</span> <span class="s1">'cet'</span><span class="p">,</span> <span class="s1">'medium'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'bjy'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Rainbow'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">,</span> <span class="s1">'cet'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'rainbow'</span><span class="p">,</span> <span class="s1">'colorwheel'</span><span class="p">,</span><span class="s1">'isolum'</span><span class="p">])</span>


<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Sequential'</span><span class="p">,</span> <span class="s1">'bokeh'</span><span class="p">,</span> <span class="s1">'bids'</span><span class="p">,</span> <span class="s1">'dark'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'Viridis'</span><span class="p">,</span> <span class="s1">'Plasma'</span><span class="p">,</span> <span class="s1">'Inferno'</span><span class="p">,</span> <span class="s1">'Magma'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Mono Sequential'</span><span class="p">,</span> <span class="s1">'bokeh'</span><span class="p">,</span> <span class="s1">'colorbrewer'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'Blues'</span><span class="p">,</span> <span class="s1">'BuGn'</span><span class="p">,</span> <span class="s1">'BuPu'</span><span class="p">,</span> <span class="s1">'GnBu'</span><span class="p">,</span> <span class="s1">'Greens'</span><span class="p">,</span> <span class="s1">'Greys'</span><span class="p">,</span>
     <span class="s1">'OrRd'</span><span class="p">,</span> <span class="s1">'Oranges'</span><span class="p">,</span> <span class="s1">'PuBu'</span><span class="p">,</span> <span class="s1">'PuBuGn'</span><span class="p">,</span> <span class="s1">'PuRd'</span><span class="p">,</span> <span class="s1">'Purples'</span><span class="p">,</span>
     <span class="s1">'RdPu'</span><span class="p">,</span> <span class="s1">'Reds'</span><span class="p">,</span> <span class="s1">'YlGn'</span><span class="p">,</span> <span class="s1">'YlGnBu'</span><span class="p">,</span> <span class="s1">'YlOrBr'</span><span class="p">,</span> <span class="s1">'YlOrRd'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Diverging'</span><span class="p">,</span> <span class="s1">'bokeh'</span><span class="p">,</span> <span class="s1">'colorbrewer'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'BrBG'</span><span class="p">,</span> <span class="s1">'PiYG'</span><span class="p">,</span> <span class="s1">'PRGn'</span><span class="p">,</span> <span class="s1">'PuOr'</span><span class="p">,</span> <span class="s1">'RdBu'</span><span class="p">,</span> <span class="s1">'RdGy'</span><span class="p">,</span>
     <span class="s1">'RdYlBu'</span><span class="p">,</span> <span class="s1">'RdYlGn'</span><span class="p">,</span> <span class="s1">'Spectral'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Categorical'</span><span class="p">,</span> <span class="s1">'bokeh'</span><span class="p">,</span> <span class="s1">'d3'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'Category10'</span><span class="p">,</span> <span class="s1">'Category20'</span><span class="p">,</span> <span class="s1">'Category20b'</span><span class="p">,</span> <span class="s1">'Category20c'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Categorical'</span><span class="p">,</span> <span class="s1">'bokeh'</span><span class="p">,</span> <span class="s1">'colorbrewer'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'Accent'</span><span class="p">,</span> <span class="s1">'Dark2'</span><span class="p">,</span> <span class="s1">'Paired'</span><span class="p">,</span> <span class="s1">'Pastel1'</span><span class="p">,</span> <span class="s1">'Pastel2'</span><span class="p">,</span>
     <span class="s1">'Set1'</span><span class="p">,</span> <span class="s1">'Set2'</span><span class="p">,</span> <span class="s1">'Set3'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Categorical'</span><span class="p">,</span> <span class="s1">'bokeh'</span><span class="p">,</span> <span class="s1">'misc'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'Colorblind'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Categorical'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">,</span> <span class="s1">'cet'</span><span class="p">,</span> <span class="s1">'any'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'glasbey'</span><span class="p">,</span> <span class="s1">'glasbey_cool'</span><span class="p">,</span> <span class="s1">'glasbey_warm'</span><span class="p">,</span> <span class="s1">'glasbey_hv'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Categorical'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">,</span> <span class="s1">'cet'</span><span class="p">,</span> <span class="s1">'dark'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'glasbey_light'</span><span class="p">])</span>

<span class="n">register_cmaps</span><span class="p">(</span><span class="s1">'Uniform Categorical'</span><span class="p">,</span> <span class="s1">'colorcet'</span><span class="p">,</span> <span class="s1">'cet'</span><span class="p">,</span> <span class="s1">'light'</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">'glasbey_dark'</span><span class="p">])</span>





<div class="viewcode-block" id="process_cmap"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.process_cmap">[docs]</a><span class="k">def</span> <span class="nf">process_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">provider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Convert valid colormap specifications to a list of colors.</span>
<span class="sd">    """</span>
    <span class="n">providers_checked</span><span class="o">=</span><span class="s2">"matplotlib, bokeh, or colorcet"</span> <span class="k">if</span> <span class="n">provider</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">provider</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">Cycle</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cmap</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">cmap</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mpl_cmaps</span> <span class="o">=</span> <span class="n">_list_cmaps</span><span class="p">(</span><span class="s1">'matplotlib'</span><span class="p">)</span>
        <span class="n">bk_cmaps</span> <span class="o">=</span> <span class="n">_list_cmaps</span><span class="p">(</span><span class="s1">'bokeh'</span><span class="p">)</span>
        <span class="n">cet_cmaps</span> <span class="o">=</span> <span class="n">_list_cmaps</span><span class="p">(</span><span class="s1">'colorcet'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">provider</span> <span class="o">==</span> <span class="s1">'matplotlib'</span> <span class="ow">or</span> <span class="p">(</span><span class="n">provider</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cmap</span> <span class="ow">in</span> <span class="n">mpl_cmaps</span> <span class="ow">or</span> <span class="n">cmap</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">mpl_cmaps</span><span class="p">)):</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">mplcmap_to_palette</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">,</span> <span class="n">categorical</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">provider</span> <span class="o">==</span> <span class="s1">'bokeh'</span> <span class="ow">or</span> <span class="p">(</span><span class="n">provider</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cmap</span> <span class="ow">in</span> <span class="n">bk_cmaps</span> <span class="ow">or</span> <span class="n">cmap</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="ow">in</span> <span class="n">bk_cmaps</span><span class="p">)):</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">bokeh_palette_to_palette</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">,</span> <span class="n">categorical</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">provider</span> <span class="o">==</span> <span class="s1">'colorcet'</span> <span class="ow">or</span> <span class="p">(</span><span class="n">provider</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cmap</span> <span class="ow">in</span> <span class="n">cet_cmaps</span><span class="p">):</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">colorcet_cmap_to_palette</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">,</span> <span class="n">categorical</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Supplied cmap </span><span class="si">%s</span><span class="s2"> not found among </span><span class="si">%s</span><span class="s2"> colormaps."</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">cmap</span><span class="p">,</span><span class="n">providers_checked</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Try processing as matplotlib colormap</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">mplcmap_to_palette</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ncolors</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"cmap argument </span><span class="si">%s</span><span class="s2"> expects a list, Cycle or valid </span><span class="si">%s</span><span class="s2"> colormap or palette."</span>
                        <span class="o">%</span> <span class="p">(</span><span class="n">cmap</span><span class="p">,</span><span class="n">providers_checked</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ncolors</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ncolors</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">palette</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">palette</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncolors</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">palette</span></div>


<div class="viewcode-block" id="color_intervals"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.color_intervals">[docs]</a><span class="k">def</span> <span class="nf">color_intervals</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">255</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Maps the supplied colors into bins defined by the supplied levels.</span>
<span class="sd">    If a clip tuple is defined the bins are clipped to the defined</span>
<span class="sd">    range otherwise the range is computed from the levels and returned.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    colors: list</span>
<span class="sd">      List of colors (usually hex string or named colors)</span>
<span class="sd">    levels: list or array_like</span>
<span class="sd">      Levels specifying the bins to map the colors to</span>
<span class="sd">    clip: tuple (optional)</span>
<span class="sd">      Lower and upper limits of the color range</span>
<span class="sd">    N: int</span>
<span class="sd">      Number of discrete colors to map the range onto</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cmap: list</span>
<span class="sd">      List of colors</span>
<span class="sd">    clip: tuple</span>
<span class="sd">      Lower and upper bounds of the color range</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'The number of colors in the colormap '</span>
                         <span class="s1">'must match the intervals defined in the '</span>
                         <span class="s1">'color_levels, expected </span><span class="si">%d</span><span class="s1"> colors found </span><span class="si">%d</span><span class="s1">.'</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)))</span>
    <span class="n">intervals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
    <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">levels</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="n">cmax</span><span class="o">-</span><span class="n">cmin</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">intv</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">intervals</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">+=</span> <span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">intv</span><span class="o">/</span><span class="n">interval</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">clip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">clmin</span><span class="p">,</span> <span class="n">clmax</span> <span class="o">=</span> <span class="n">clip</span>
        <span class="n">lidx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="p">((</span><span class="n">clmin</span><span class="o">-</span><span class="n">cmin</span><span class="p">)</span><span class="o">/</span><span class="n">interval</span><span class="p">)))</span>
        <span class="n">uidx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="p">((</span><span class="n">cmax</span><span class="o">-</span><span class="n">clmax</span><span class="p">)</span><span class="o">/</span><span class="n">interval</span><span class="p">)))</span>
        <span class="n">uidx</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="n">uidx</span>
        <span class="k">if</span> <span class="n">lidx</span> <span class="o">==</span> <span class="n">uidx</span><span class="p">:</span>
            <span class="n">uidx</span> <span class="o">=</span> <span class="n">lidx</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">[</span><span class="n">lidx</span><span class="p">:</span><span class="n">uidx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">clmin</span> <span class="o">==</span> <span class="n">clmax</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span><span class="o">-</span><span class="n">clmin</span><span class="p">))</span>
            <span class="n">clip</span> <span class="o">=</span> <span class="n">levels</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span> <span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">idx</span><span class="o">+</span><span class="mi">2</span> <span class="k">else</span> <span class="n">levels</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">clip</span></div>


<div class="viewcode-block" id="dim_axis_label"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.dim_axis_label">[docs]</a><span class="k">def</span> <span class="nf">dim_axis_label</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">', '</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Returns an axis label for one or more dimensions.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimensions</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="n">dimensions</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">separator</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">pprint_label</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">])</span></div>


<div class="viewcode-block" id="scale_fontsize"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.scale_fontsize">[docs]</a><span class="k">def</span> <span class="nf">scale_fontsize</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">scaling</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Scales a numeric or string font size.</span>
<span class="sd">    """</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">"[-+]?\d*\.\d+|\d+"</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">size</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
            <span class="n">size</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">size</span>

    <span class="k">if</span> <span class="n">scaling</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">size</span> <span class="o">*</span> <span class="n">scaling</span>

    <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'</span><span class="si">%.3f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">'0'</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span> <span class="o">+</span> <span class="n">ext</span>
    <span class="k">return</span> <span class="n">size</span></div>


<div class="viewcode-block" id="attach_streams"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.attach_streams">[docs]</a><span class="k">def</span> <span class="nf">attach_streams</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">precedence</span><span class="o">=</span><span class="mf">1.1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Attaches plot refresh to all streams on the object.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">append_refresh</span><span class="p">(</span><span class="n">dmap</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">get_nested_streams</span><span class="p">(</span><span class="n">dmap</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">plot</span><span class="o">.</span><span class="n">refresh</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">:</span>
                <span class="n">stream</span><span class="o">.</span><span class="n">add_subscriber</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">refresh</span><span class="p">,</span> <span class="n">precedence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">append_refresh</span><span class="p">,</span> <span class="p">[</span><span class="n">DynamicMap</span><span class="p">])</span></div>


<div class="viewcode-block" id="traverse_setter"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.traverse_setter">[docs]</a><span class="k">def</span> <span class="nf">traverse_setter</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Traverses the object and sets the supplied attribute on the</span>
<span class="sd">    object. Supports Dimensioned and DimensionedPlot types.</span>
<span class="sd">    """</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span></div>


<span class="k">def</span> <span class="nf">_get_min_distance_numpy</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    NumPy based implementation of get_min_distance</span>
<span class="sd">    """</span>
    <span class="n">xys</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'invalid value encountered in'</span><span class="p">)</span>
        <span class="n">xys</span> <span class="o">=</span> <span class="n">xys</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float32'</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xys</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">xys</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="n">distances</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">distances</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">distances</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">0</span>


<div class="viewcode-block" id="get_min_distance"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.get_min_distance">[docs]</a><span class="k">def</span> <span class="nf">get_min_distance</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Gets the minimum sampling distance of the x- and y-coordinates</span>
<span class="sd">    in a grid.</span>
<span class="sd">    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
        <span class="k">return</span> <span class="n">pdist</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_min_distance_numpy</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_directed_graph_paths"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.get_directed_graph_paths">[docs]</a><span class="k">def</span> <span class="nf">get_directed_graph_paths</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">arrow_length</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Computes paths for a directed path which include an arrow to</span>
<span class="sd">    indicate the directionality of each edge.</span>
<span class="sd">    """</span>
    <span class="n">edgepaths</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">_split_edgepaths</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">edgepaths</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">datatype</span><span class="o">=</span><span class="s1">'array'</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="n">edgepaths</span><span class="o">.</span><span class="n">kdims</span><span class="p">)</span>
    <span class="n">arrows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">ey</span><span class="o">-</span><span class="n">sy</span><span class="p">,</span> <span class="n">ex</span><span class="o">-</span><span class="n">sx</span><span class="p">)</span>
        <span class="n">xa0</span> <span class="o">=</span> <span class="n">ex</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rad</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">arrow_length</span>
        <span class="n">ya0</span> <span class="o">=</span> <span class="n">ey</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rad</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">arrow_length</span>
        <span class="n">xa1</span> <span class="o">=</span> <span class="n">ex</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rad</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">arrow_length</span>
        <span class="n">ya1</span> <span class="o">=</span> <span class="n">ey</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rad</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">arrow_length</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">),</span> <span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
                          <span class="p">(</span><span class="n">xa0</span><span class="p">,</span> <span class="n">ya0</span><span class="p">),</span> <span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">),</span> <span class="p">(</span><span class="n">xa1</span><span class="p">,</span> <span class="n">ya1</span><span class="p">)])</span>
        <span class="n">arrows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrow</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">arrows</span></div>


<div class="viewcode-block" id="rgb2hex"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.rgb2hex">[docs]</a><span class="k">def</span> <span class="nf">rgb2hex</span><span class="p">(</span><span class="n">rgb</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Convert RGB(A) tuple to hex.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">rgb</span> <span class="o">=</span> <span class="n">rgb</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="s2">"#</span><span class="si">{0:02x}{1:02x}{2:02x}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">rgb</span><span class="p">))</span></div>


<div class="viewcode-block" id="dim_range_key"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.dim_range_key">[docs]</a><span class="k">def</span> <span class="nf">dim_range_key</span><span class="p">(</span><span class="n">eldim</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Returns the key to look up a dimension range.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eldim</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
        <span class="n">dim_name</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">eldim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dim_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"dim('"</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dim_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"')"</span><span class="p">):</span>
            <span class="n">dim_name</span> <span class="o">=</span> <span class="n">dim_name</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dim_name</span> <span class="o">=</span> <span class="n">eldim</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">dim_name</span></div>


<div class="viewcode-block" id="hex2rgb"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.hex2rgb">[docs]</a><span class="k">def</span> <span class="nf">hex2rgb</span><span class="p">(</span><span class="nb">hex</span><span class="p">):</span>
  <span class="sd">''' "#FFFFFF" -&gt; [255,255,255] '''</span>
  <span class="c1"># Pass 16 to the integer function for change of base</span>
  <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">hex</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span></div>


<div class="viewcode-block" id="apply_nodata"><a class="viewcode-back" href="../../../reference_manual/holoviews.plotting.html#holoviews.plotting.util.apply_nodata">[docs]</a><span class="k">class</span> <span class="nc">apply_nodata</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>

    <span class="n">nodata</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        Optional missing-data value for integer data.</span>
<span class="s2">        If non-None, data with this value will be replaced with NaN so</span>
<span class="s2">        that it is transparent (by default) when plotted."""</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_replace_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="s2">"Replace `nodata` value in data with NaN, if specified in opts"</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float64'</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">data</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">nodata</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">'where'</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">nodata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">element</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s1">'interface'</span><span class="p">):</span>
            <span class="n">vdim</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">vdims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">vdim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">'iu'</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">element</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">dim</span><span class="p">(</span><span class="n">vdim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_replace_value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">element</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">vdim</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">transform</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">dimension_values</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">'iu'</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">element</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float64'</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">element</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_replace_value</span><span class="p">(</span><span class="n">array</span><span class="p">))</span></div>


<span class="n">RGB_HEX_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">'^#(?:[0-9a-fA-F]</span><span class="si">{3}</span><span class="s1">){1,2}$'</span><span class="p">)</span>

<span class="n">COLOR_ALIASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'b'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">'c'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
    <span class="s1">'g'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="s1">'k'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="s1">'m'</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
    <span class="s1">'r'</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="s1">'w'</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">'y'</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="s1">'transparent'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>


<span class="c1"># linear_kryw_0_100_c71 (aka "fire"):</span>
<span class="c1"># A perceptually uniform equivalent of matplotlib's "hot" colormap, from</span>
<span class="c1"># http://peterkovesi.com/projects/colourmaps</span>

<span class="n">fire_colors</span> <span class="o">=</span> <span class="n">linear_kryw_0_100_c71</span> <span class="o">=</span> <span class="p">[</span>\
<span class="p">[</span><span class="mi">0</span><span class="p">,</span>        <span class="mi">0</span><span class="p">,</span>           <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.027065</span><span class="p">,</span> <span class="mf">2.143e-05</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.052054</span><span class="p">,</span> <span class="mf">7.4728e-05</span><span class="p">,</span>  <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.071511</span><span class="p">,</span> <span class="mf">0.00013914</span><span class="p">,</span>  <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.08742</span><span class="p">,</span>  <span class="mf">0.0002088</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.10109</span><span class="p">,</span>  <span class="mf">0.00028141</span><span class="p">,</span>  <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.11337</span><span class="p">,</span>  <span class="mf">0.000356</span><span class="p">,</span>    <span class="mf">2.4266e-17</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.12439</span><span class="p">,</span>  <span class="mf">0.00043134</span><span class="p">,</span>  <span class="mf">3.3615e-17</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.13463</span><span class="p">,</span>  <span class="mf">0.00050796</span><span class="p">,</span>  <span class="mf">2.1604e-17</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.14411</span><span class="p">,</span>  <span class="mf">0.0005856</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.15292</span><span class="p">,</span>  <span class="mf">0.00070304</span><span class="p">,</span>  <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.16073</span><span class="p">,</span>  <span class="mf">0.0013432</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.16871</span><span class="p">,</span>  <span class="mf">0.0014516</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.17657</span><span class="p">,</span>  <span class="mf">0.0012408</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.18364</span><span class="p">,</span>  <span class="mf">0.0015336</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.19052</span><span class="p">,</span>  <span class="mf">0.0017515</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.19751</span><span class="p">,</span>  <span class="mf">0.0015146</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.20401</span><span class="p">,</span>  <span class="mf">0.0015249</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.20994</span><span class="p">,</span>  <span class="mf">0.0019639</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.21605</span><span class="p">,</span>  <span class="mf">0.002031</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.22215</span><span class="p">,</span>  <span class="mf">0.0017559</span><span class="p">,</span>   <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.22808</span><span class="p">,</span>  <span class="mf">0.001546</span><span class="p">,</span>    <span class="mf">1.8755e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.23378</span><span class="p">,</span>  <span class="mf">0.0016315</span><span class="p">,</span>   <span class="mf">3.5012e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.23955</span><span class="p">,</span>  <span class="mf">0.0017194</span><span class="p">,</span>   <span class="mf">3.3352e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.24531</span><span class="p">,</span>  <span class="mf">0.0018097</span><span class="p">,</span>   <span class="mf">1.8559e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.25113</span><span class="p">,</span>  <span class="mf">0.0019038</span><span class="p">,</span>   <span class="mf">1.9139e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.25694</span><span class="p">,</span>  <span class="mf">0.0020015</span><span class="p">,</span>   <span class="mf">3.5308e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.26278</span><span class="p">,</span>  <span class="mf">0.0021017</span><span class="p">,</span>   <span class="mf">3.2613e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.26864</span><span class="p">,</span>  <span class="mf">0.0022048</span><span class="p">,</span>   <span class="mf">2.0338e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.27451</span><span class="p">,</span>  <span class="mf">0.0023119</span><span class="p">,</span>   <span class="mf">2.2453e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.28041</span><span class="p">,</span>  <span class="mf">0.0024227</span><span class="p">,</span>   <span class="mf">3.6003e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.28633</span><span class="p">,</span>  <span class="mf">0.0025363</span><span class="p">,</span>   <span class="mf">2.9817e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.29229</span><span class="p">,</span>  <span class="mf">0.0026532</span><span class="p">,</span>   <span class="mf">1.9559e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.29824</span><span class="p">,</span>  <span class="mf">0.0027747</span><span class="p">,</span>   <span class="mf">2.7666e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.30423</span><span class="p">,</span>  <span class="mf">0.0028999</span><span class="p">,</span>   <span class="mf">3.5752e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.31026</span><span class="p">,</span>  <span class="mf">0.0030279</span><span class="p">,</span>   <span class="mf">2.3231e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.31628</span><span class="p">,</span>  <span class="mf">0.0031599</span><span class="p">,</span>   <span class="mf">1.2902e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.32232</span><span class="p">,</span>  <span class="mf">0.0032974</span><span class="p">,</span>   <span class="mf">3.2915e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.32838</span><span class="p">,</span>  <span class="mf">0.0034379</span><span class="p">,</span>   <span class="mf">3.2803e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.33447</span><span class="p">,</span>  <span class="mf">0.0035819</span><span class="p">,</span>   <span class="mf">2.0757e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.34057</span><span class="p">,</span>  <span class="mf">0.003731</span><span class="p">,</span>    <span class="mf">2.3831e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.34668</span><span class="p">,</span>  <span class="mf">0.0038848</span><span class="p">,</span>   <span class="mf">3.502e-05</span> <span class="p">],</span>
<span class="p">[</span><span class="mf">0.35283</span><span class="p">,</span>  <span class="mf">0.0040418</span><span class="p">,</span>   <span class="mf">2.4468e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.35897</span><span class="p">,</span>  <span class="mf">0.0042032</span><span class="p">,</span>   <span class="mf">1.1444e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.36515</span><span class="p">,</span>  <span class="mf">0.0043708</span><span class="p">,</span>   <span class="mf">3.2793e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.37134</span><span class="p">,</span>  <span class="mf">0.0045418</span><span class="p">,</span>   <span class="mf">3.012e-05</span> <span class="p">],</span>
<span class="p">[</span><span class="mf">0.37756</span><span class="p">,</span>  <span class="mf">0.0047169</span><span class="p">,</span>   <span class="mf">1.4846e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.38379</span><span class="p">,</span>  <span class="mf">0.0048986</span><span class="p">,</span>   <span class="mf">2.796e-05</span> <span class="p">],</span>
<span class="p">[</span><span class="mf">0.39003</span><span class="p">,</span>  <span class="mf">0.0050848</span><span class="p">,</span>   <span class="mf">3.2782e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.3963</span><span class="p">,</span>   <span class="mf">0.0052751</span><span class="p">,</span>   <span class="mf">1.9244e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.40258</span><span class="p">,</span>  <span class="mf">0.0054715</span><span class="p">,</span>   <span class="mf">2.2667e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.40888</span><span class="p">,</span>  <span class="mf">0.0056736</span><span class="p">,</span>   <span class="mf">3.3223e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.41519</span><span class="p">,</span>  <span class="mf">0.0058798</span><span class="p">,</span>   <span class="mf">2.159e-05</span> <span class="p">],</span>  <span class="p">[</span><span class="mf">0.42152</span><span class="p">,</span>  <span class="mf">0.0060922</span><span class="p">,</span>   <span class="mf">1.8214e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.42788</span><span class="p">,</span>  <span class="mf">0.0063116</span><span class="p">,</span>   <span class="mf">3.2525e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.43424</span><span class="p">,</span>  <span class="mf">0.0065353</span><span class="p">,</span>   <span class="mf">2.2247e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.44062</span><span class="p">,</span>  <span class="mf">0.006765</span><span class="p">,</span>    <span class="mf">1.5852e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.44702</span><span class="p">,</span>  <span class="mf">0.0070024</span><span class="p">,</span>   <span class="mf">3.1769e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.45344</span><span class="p">,</span>  <span class="mf">0.0072442</span><span class="p">,</span>   <span class="mf">2.1245e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.45987</span><span class="p">,</span>  <span class="mf">0.0074929</span><span class="p">,</span>   <span class="mf">1.5726e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.46631</span><span class="p">,</span>  <span class="mf">0.0077499</span><span class="p">,</span>   <span class="mf">3.0976e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.47277</span><span class="p">,</span>  <span class="mf">0.0080108</span><span class="p">,</span>   <span class="mf">1.8722e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.47926</span><span class="p">,</span>  <span class="mf">0.0082789</span><span class="p">,</span>   <span class="mf">1.9285e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.48574</span><span class="p">,</span>  <span class="mf">0.0085553</span><span class="p">,</span>   <span class="mf">3.0063e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.49225</span><span class="p">,</span>  <span class="mf">0.0088392</span><span class="p">,</span>   <span class="mf">1.4313e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.49878</span><span class="p">,</span>  <span class="mf">0.0091356</span><span class="p">,</span>   <span class="mf">2.3404e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.50531</span><span class="p">,</span>  <span class="mf">0.0094374</span><span class="p">,</span>   <span class="mf">2.8099e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.51187</span><span class="p">,</span>  <span class="mf">0.0097365</span><span class="p">,</span>   <span class="mf">6.4695e-06</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.51844</span><span class="p">,</span>  <span class="mf">0.010039</span><span class="p">,</span>    <span class="mf">2.5791e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.52501</span><span class="p">,</span>  <span class="mf">0.010354</span><span class="p">,</span>    <span class="mf">2.4393e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.53162</span><span class="p">,</span>  <span class="mf">0.010689</span><span class="p">,</span>    <span class="mf">1.6037e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.53825</span><span class="p">,</span>  <span class="mf">0.011031</span><span class="p">,</span>    <span class="mf">2.7295e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.54489</span><span class="p">,</span>  <span class="mf">0.011393</span><span class="p">,</span>    <span class="mf">1.5848e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.55154</span><span class="p">,</span>  <span class="mf">0.011789</span><span class="p">,</span>    <span class="mf">2.3111e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.55818</span><span class="p">,</span>  <span class="mf">0.012159</span><span class="p">,</span>    <span class="mf">2.5416e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.56485</span><span class="p">,</span>  <span class="mf">0.012508</span><span class="p">,</span>    <span class="mf">1.5064e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.57154</span><span class="p">,</span>  <span class="mf">0.012881</span><span class="p">,</span>    <span class="mf">2.541e-05</span> <span class="p">],</span>  <span class="p">[</span><span class="mf">0.57823</span><span class="p">,</span>  <span class="mf">0.013283</span><span class="p">,</span>    <span class="mf">1.6166e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.58494</span><span class="p">,</span>  <span class="mf">0.013701</span><span class="p">,</span>    <span class="mf">2.263e-05</span> <span class="p">],</span>  <span class="p">[</span><span class="mf">0.59166</span><span class="p">,</span>  <span class="mf">0.014122</span><span class="p">,</span>    <span class="mf">2.3316e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.59839</span><span class="p">,</span>  <span class="mf">0.014551</span><span class="p">,</span>    <span class="mf">1.9432e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.60514</span><span class="p">,</span>  <span class="mf">0.014994</span><span class="p">,</span>    <span class="mf">2.4323e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.6119</span><span class="p">,</span>   <span class="mf">0.01545</span><span class="p">,</span>     <span class="mf">1.3929e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.61868</span><span class="p">,</span>  <span class="mf">0.01592</span><span class="p">,</span>     <span class="mf">2.1615e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.62546</span><span class="p">,</span>  <span class="mf">0.016401</span><span class="p">,</span>    <span class="mf">1.5846e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.63226</span><span class="p">,</span>  <span class="mf">0.016897</span><span class="p">,</span>    <span class="mf">2.0838e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.63907</span><span class="p">,</span>  <span class="mf">0.017407</span><span class="p">,</span>    <span class="mf">1.9549e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.64589</span><span class="p">,</span>  <span class="mf">0.017931</span><span class="p">,</span>    <span class="mf">2.0961e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.65273</span><span class="p">,</span>  <span class="mf">0.018471</span><span class="p">,</span>    <span class="mf">2.0737e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.65958</span><span class="p">,</span>  <span class="mf">0.019026</span><span class="p">,</span>    <span class="mf">2.0621e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.66644</span><span class="p">,</span>  <span class="mf">0.019598</span><span class="p">,</span>    <span class="mf">2.0675e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.67332</span><span class="p">,</span>  <span class="mf">0.020187</span><span class="p">,</span>    <span class="mf">2.0301e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.68019</span><span class="p">,</span>  <span class="mf">0.020793</span><span class="p">,</span>    <span class="mf">2.0029e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.68709</span><span class="p">,</span>  <span class="mf">0.021418</span><span class="p">,</span>    <span class="mf">2.0088e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.69399</span><span class="p">,</span>  <span class="mf">0.022062</span><span class="p">,</span>    <span class="mf">1.9102e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.70092</span><span class="p">,</span>  <span class="mf">0.022727</span><span class="p">,</span>    <span class="mf">1.9662e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.70784</span><span class="p">,</span>  <span class="mf">0.023412</span><span class="p">,</span>    <span class="mf">1.7757e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.71478</span><span class="p">,</span>  <span class="mf">0.024121</span><span class="p">,</span>    <span class="mf">1.8236e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.72173</span><span class="p">,</span>  <span class="mf">0.024852</span><span class="p">,</span>    <span class="mf">1.4944e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.7287</span><span class="p">,</span>   <span class="mf">0.025608</span><span class="p">,</span>    <span class="mf">2.0245e-06</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.73567</span><span class="p">,</span>  <span class="mf">0.02639</span><span class="p">,</span>     <span class="mf">1.5013e-07</span><span class="p">],</span>  <span class="p">[</span><span class="mf">0.74266</span><span class="p">,</span>  <span class="mf">0.027199</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.74964</span><span class="p">,</span>  <span class="mf">0.028038</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.75665</span><span class="p">,</span>  <span class="mf">0.028906</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.76365</span><span class="p">,</span>  <span class="mf">0.029806</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.77068</span><span class="p">,</span>  <span class="mf">0.030743</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.77771</span><span class="p">,</span>  <span class="mf">0.031711</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.78474</span><span class="p">,</span>  <span class="mf">0.032732</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.79179</span><span class="p">,</span>  <span class="mf">0.033741</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.79886</span><span class="p">,</span>  <span class="mf">0.034936</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.80593</span><span class="p">,</span>  <span class="mf">0.036031</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.81299</span><span class="p">,</span>  <span class="mf">0.03723</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.82007</span><span class="p">,</span>  <span class="mf">0.038493</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.82715</span><span class="p">,</span>  <span class="mf">0.039819</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.83423</span><span class="p">,</span>  <span class="mf">0.041236</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.84131</span><span class="p">,</span>  <span class="mf">0.042647</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.84838</span><span class="p">,</span>  <span class="mf">0.044235</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.85545</span><span class="p">,</span>  <span class="mf">0.045857</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.86252</span><span class="p">,</span>  <span class="mf">0.047645</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.86958</span><span class="p">,</span>  <span class="mf">0.049578</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.87661</span><span class="p">,</span>  <span class="mf">0.051541</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.88365</span><span class="p">,</span>  <span class="mf">0.053735</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.89064</span><span class="p">,</span>  <span class="mf">0.056168</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.89761</span><span class="p">,</span>  <span class="mf">0.058852</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.90451</span><span class="p">,</span>  <span class="mf">0.061777</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.91131</span><span class="p">,</span>  <span class="mf">0.065281</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.91796</span><span class="p">,</span>  <span class="mf">0.069448</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.92445</span><span class="p">,</span>  <span class="mf">0.074684</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.93061</span><span class="p">,</span>  <span class="mf">0.08131</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.93648</span><span class="p">,</span>  <span class="mf">0.088878</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.94205</span><span class="p">,</span>  <span class="mf">0.097336</span><span class="p">,</span>    <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.9473</span><span class="p">,</span>   <span class="mf">0.10665</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.9522</span><span class="p">,</span>   <span class="mf">0.1166</span><span class="p">,</span>      <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.95674</span><span class="p">,</span>  <span class="mf">0.12716</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.96094</span><span class="p">,</span>  <span class="mf">0.13824</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.96479</span><span class="p">,</span>  <span class="mf">0.14963</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.96829</span><span class="p">,</span>  <span class="mf">0.16128</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.97147</span><span class="p">,</span>  <span class="mf">0.17303</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.97436</span><span class="p">,</span>  <span class="mf">0.18489</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.97698</span><span class="p">,</span>  <span class="mf">0.19672</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.97934</span><span class="p">,</span>  <span class="mf">0.20846</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.98148</span><span class="p">,</span>  <span class="mf">0.22013</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.9834</span><span class="p">,</span>   <span class="mf">0.23167</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.98515</span><span class="p">,</span>  <span class="mf">0.24301</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.98672</span><span class="p">,</span>  <span class="mf">0.25425</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.98815</span><span class="p">,</span>  <span class="mf">0.26525</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.98944</span><span class="p">,</span>  <span class="mf">0.27614</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99061</span><span class="p">,</span>  <span class="mf">0.28679</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.99167</span><span class="p">,</span>  <span class="mf">0.29731</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99263</span><span class="p">,</span>  <span class="mf">0.30764</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.9935</span><span class="p">,</span>   <span class="mf">0.31781</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99428</span><span class="p">,</span>  <span class="mf">0.3278</span><span class="p">,</span>      <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.995</span><span class="p">,</span>    <span class="mf">0.33764</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99564</span><span class="p">,</span>  <span class="mf">0.34735</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.99623</span><span class="p">,</span>  <span class="mf">0.35689</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99675</span><span class="p">,</span>  <span class="mf">0.3663</span><span class="p">,</span>      <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.99722</span><span class="p">,</span>  <span class="mf">0.37556</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99765</span><span class="p">,</span>  <span class="mf">0.38471</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.99803</span><span class="p">,</span>  <span class="mf">0.39374</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99836</span><span class="p">,</span>  <span class="mf">0.40265</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.99866</span><span class="p">,</span>  <span class="mf">0.41145</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99892</span><span class="p">,</span>  <span class="mf">0.42015</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.99915</span><span class="p">,</span>  <span class="mf">0.42874</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99935</span><span class="p">,</span>  <span class="mf">0.43724</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.99952</span><span class="p">,</span>  <span class="mf">0.44563</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99966</span><span class="p">,</span>  <span class="mf">0.45395</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.99977</span><span class="p">,</span>  <span class="mf">0.46217</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99986</span><span class="p">,</span>  <span class="mf">0.47032</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mf">0.99993</span><span class="p">,</span>  <span class="mf">0.47838</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mf">0.99997</span><span class="p">,</span>  <span class="mf">0.48638</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.4943</span><span class="p">,</span>      <span class="mi">0</span>         <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.50214</span><span class="p">,</span>     <span class="mi">0</span>         <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.50991</span><span class="p">,</span>     <span class="mf">1.2756e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.51761</span><span class="p">,</span>     <span class="mf">4.5388e-05</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.52523</span><span class="p">,</span>     <span class="mf">9.6977e-05</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.5328</span><span class="p">,</span>      <span class="mf">0.00016858</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.54028</span><span class="p">,</span>     <span class="mf">0.0002582</span> <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.54771</span><span class="p">,</span>     <span class="mf">0.00036528</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.55508</span><span class="p">,</span>     <span class="mf">0.00049276</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.5624</span><span class="p">,</span>      <span class="mf">0.00063955</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.56965</span><span class="p">,</span>     <span class="mf">0.00080443</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.57687</span><span class="p">,</span>     <span class="mf">0.00098902</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.58402</span><span class="p">,</span>     <span class="mf">0.0011943</span> <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.59113</span><span class="p">,</span>     <span class="mf">0.0014189</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.59819</span><span class="p">,</span>     <span class="mf">0.0016626</span> <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.60521</span><span class="p">,</span>     <span class="mf">0.0019281</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.61219</span><span class="p">,</span>     <span class="mf">0.0022145</span> <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.61914</span><span class="p">,</span>     <span class="mf">0.0025213</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.62603</span><span class="p">,</span>     <span class="mf">0.0028496</span> <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.6329</span><span class="p">,</span>      <span class="mf">0.0032006</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.63972</span><span class="p">,</span>     <span class="mf">0.0035741</span> <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.64651</span><span class="p">,</span>     <span class="mf">0.0039701</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.65327</span><span class="p">,</span>     <span class="mf">0.0043898</span> <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.66</span><span class="p">,</span>        <span class="mf">0.0048341</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.66669</span><span class="p">,</span>     <span class="mf">0.005303</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.67336</span><span class="p">,</span>     <span class="mf">0.0057969</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.67999</span><span class="p">,</span>     <span class="mf">0.006317</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.68661</span><span class="p">,</span>     <span class="mf">0.0068648</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.69319</span><span class="p">,</span>     <span class="mf">0.0074406</span> <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.69974</span><span class="p">,</span>     <span class="mf">0.0080433</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.70628</span><span class="p">,</span>     <span class="mf">0.0086756</span> <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.71278</span><span class="p">,</span>     <span class="mf">0.0093486</span> <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.71927</span><span class="p">,</span>     <span class="mf">0.010023</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.72573</span><span class="p">,</span>     <span class="mf">0.010724</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.73217</span><span class="p">,</span>     <span class="mf">0.011565</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.73859</span><span class="p">,</span>     <span class="mf">0.012339</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.74499</span><span class="p">,</span>     <span class="mf">0.01316</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.75137</span><span class="p">,</span>     <span class="mf">0.014042</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.75772</span><span class="p">,</span>     <span class="mf">0.014955</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.76406</span><span class="p">,</span>     <span class="mf">0.015913</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.77039</span><span class="p">,</span>     <span class="mf">0.016915</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.77669</span><span class="p">,</span>     <span class="mf">0.017964</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.78298</span><span class="p">,</span>     <span class="mf">0.019062</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.78925</span><span class="p">,</span>     <span class="mf">0.020212</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.7955</span><span class="p">,</span>      <span class="mf">0.021417</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.80174</span><span class="p">,</span>     <span class="mf">0.02268</span>   <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.80797</span><span class="p">,</span>     <span class="mf">0.024005</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.81418</span><span class="p">,</span>     <span class="mf">0.025396</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.82038</span><span class="p">,</span>     <span class="mf">0.026858</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.82656</span><span class="p">,</span>     <span class="mf">0.028394</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.83273</span><span class="p">,</span>     <span class="mf">0.030013</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.83889</span><span class="p">,</span>     <span class="mf">0.031717</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.84503</span><span class="p">,</span>     <span class="mf">0.03348</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.85116</span><span class="p">,</span>     <span class="mf">0.035488</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.85728</span><span class="p">,</span>     <span class="mf">0.037452</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.8634</span><span class="p">,</span>      <span class="mf">0.039592</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.86949</span><span class="p">,</span>     <span class="mf">0.041898</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.87557</span><span class="p">,</span>     <span class="mf">0.044392</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.88165</span><span class="p">,</span>     <span class="mf">0.046958</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.88771</span><span class="p">,</span>     <span class="mf">0.04977</span>   <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.89376</span><span class="p">,</span>     <span class="mf">0.052828</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.8998</span><span class="p">,</span>      <span class="mf">0.056209</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.90584</span><span class="p">,</span>     <span class="mf">0.059919</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.91185</span><span class="p">,</span>     <span class="mf">0.063925</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.91783</span><span class="p">,</span>     <span class="mf">0.068579</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.92384</span><span class="p">,</span>     <span class="mf">0.073948</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.92981</span><span class="p">,</span>     <span class="mf">0.080899</span>  <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.93576</span><span class="p">,</span>     <span class="mf">0.090648</span>  <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.94166</span><span class="p">,</span>     <span class="mf">0.10377</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.94752</span><span class="p">,</span>     <span class="mf">0.12051</span>   <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.9533</span><span class="p">,</span>      <span class="mf">0.14149</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.959</span><span class="p">,</span>       <span class="mf">0.1672</span>    <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.96456</span><span class="p">,</span>     <span class="mf">0.19823</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.96995</span><span class="p">,</span>     <span class="mf">0.23514</span>   <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.9751</span><span class="p">,</span>      <span class="mf">0.2786</span>    <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.97992</span><span class="p">,</span>     <span class="mf">0.32883</span>   <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.98432</span><span class="p">,</span>     <span class="mf">0.38571</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.9882</span><span class="p">,</span>      <span class="mf">0.44866</span>   <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.9915</span><span class="p">,</span>      <span class="mf">0.51653</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.99417</span><span class="p">,</span>     <span class="mf">0.58754</span>   <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.99625</span><span class="p">,</span>     <span class="mf">0.65985</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.99778</span><span class="p">,</span>     <span class="mf">0.73194</span>   <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.99885</span><span class="p">,</span>     <span class="mf">0.80259</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.99953</span><span class="p">,</span>     <span class="mf">0.87115</span>   <span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mf">0.99989</span><span class="p">,</span>     <span class="mf">0.93683</span>   <span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>        <span class="mi">1</span><span class="p">,</span>           <span class="mi">1</span>         <span class="p">]]</span>

<span class="c1"># Bokeh palette</span>
<span class="n">fire</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">'#</span><span class="si">{0:02x}{1:02x}{2:02x}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mi">255</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="mi">255</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="mi">255</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">fire_colors</span><span class="p">]</span>
</pre></div>
</div>
<!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
</main>
</div>
</div>
<script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
<div class="container">
<div class="footer-item">
<p class="copyright">
    Â© Copyright 2021 HoloViz developers.<br/>
</p>
</div>
<div class="footer-item">
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.1.<br/>
</p>
</div>
</div>
</footer>
</body>
</html>